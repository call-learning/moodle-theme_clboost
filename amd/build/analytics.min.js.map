{"version":3,"file":"analytics.min.js","sources":["../src/analytics.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * This is the main analytics code that will trigger google analytics when\n * the right event is triggered (policy accepted)\n *\n * @module   theme_clboost\n * @copyright 2021 - CALL Learning - Laurent David <laurent@call-learning.fr>\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n/**\n * Initialize the analytics code\n * @param {String} gatriggerid\n * @param {String} gacode\n */\nexport const init = function (gatriggerid, gacode) {\n    const checkGAPolicyAccepted =  (event) => {\n        const policies = event.detail;\n        if (policies) {\n            const found = policies.find(\n                (policy) => {\n                    return policy.policyversionid == gatriggerid;\n                }\n            );\n            if (found && found.accepted) {\n                window.ga('create', gacode, 'auto');\n                window.ga('set', 'anonymizeIp', true);\n                window.ga('set', 'allowAdFeatures', false);\n                window.ga('send', 'pageview');\n            }\n        }\n    };\n    document.addEventListener('grpd_policies_accepted', checkGAPolicyAccepted);\n    document.addEventListener('grpd_policies_current_status', checkGAPolicyAccepted);\n};"],"names":["gatriggerid","gacode","checkGAPolicyAccepted","event","policies","detail","found","find","policy","policyversionid","accepted","window","ga","document","addEventListener"],"mappings":"4JA4BoB,SAAUA,YAAaC,cACjCC,sBAA0BC,cACtBC,SAAWD,MAAME,UACnBD,SAAU,OACJE,MAAQF,SAASG,MAClBC,QACUA,OAAOC,iBAAmBT,cAGrCM,OAASA,MAAMI,WACfC,OAAOC,GAAG,SAAUX,OAAQ,QAC5BU,OAAOC,GAAG,MAAO,eAAe,GAChCD,OAAOC,GAAG,MAAO,mBAAmB,GACpCD,OAAOC,GAAG,OAAQ,eAI9BC,SAASC,iBAAiB,yBAA0BZ,uBACpDW,SAASC,iBAAiB,+BAAgCZ"}